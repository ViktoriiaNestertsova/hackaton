# hackaton
#імпорт бібліотек
from colorama import Fore, Style, init
import time
import sys
import os
import scipy.io.wavfile as wav
import sounddevice as sd
import threading

#Для кольорового виведення тексту
if os.name == 'nt':
    os.system('color')

# Змінна для управління звуком
sound_on = True # True, якщо є звукові файли

init(autoreset=True) # autoreset=True важливий!

# Функції для звуку 
def play_sound_threaded(filename, duration=None):
    def play():
        try:
            # Перевірка, чи файл існує
            if not os.path.exists(filename):
                 # Використовуємо print напряму або slow_print без кольору, якщо хочете
                 # print(f"Помилка: Файл '{filename}' не знайдено.")
                 slow_print(f"Помилка: Файл '{filename}' не знайдено.") # Приклад без кольору, якщо slow_print вже змінений
                 return # Зупиняємо виконання play() якщо файл не знайдено

            fs, data = wav.read(filename)
            data_to_play = data

            if duration:
                samples = int(duration * fs)
                # Перевірка, чи запитувана тривалість не перевищує довжину файлу
                if samples <= data.shape[0]: 
                    data_to_play = data[:samples]
                else: 
                    # Попередження, якщо файл коротший, використовуємо slow_print без кольору
                    slow_print(f"Попередження: Звуковий файл '{filename}' коротший за '{duration}с'. Відтворюється повністю.")
                    # data_too_play залишиться повним файлом, що є коректно

            sd.play(data_to_play, fs)
            # sd.wait() # Якщо потрібно чекати завершення звуку в потоці - зазвичай не потрібно в окремому потоці

        except FileNotFoundError:
             # Цей блок може дублювати перевірку вище, але хай буде для надійності
             slow_print(f"Помилка: Файл '{filename}' не знайдено.")
        except Exception as e:
            # Повідомлення про інші помилки відтворення, використовуємо slow_print без кольору
            slow_print(f"Помилка відтворення звуку '{filename}': {e}")


    if sound_on:
        sound_thread = threading.Thread(target=play)
        sound_thread.daemon = True # Робить потік фоновим, щоб він не заважав завершенню програми
        sound_thread.start()


def play_sound_blocking(filename, duration=None):
    if not sound_on:
        return
    try:
        fs, data = wav.read(filename)
        data_to_play = data
        if duration:
            samples = int(duration * fs)
            if samples <= data.shape[0]:
                 data_to_play = data[:samples]
            else:
                print(f"{Fore.YELLOW}Попередження: Звуковий файл '{filename}' коротший за '{duration}с'. Відтворюється повністю.{Style.RESET_ALL}")
        sd.play(data_to_play, fs)
        sd.wait()
    except FileNotFoundError:
        print(f"{Fore.RED}Помилка: Файл '{filename}' не знайдено.{Style.RESET_ALL}")
    except Exception as e:
        print(f"{Fore.RED}Помилка відтворення звуку '{filename}': {e}{Style.RESET_ALL}")

# функція slow_print 
def slow_print(text, color=None, delay=0.04, end_with_newline=True): # Залишаємо параметр color, але не використовуємо його
    """Повільно виводить текст посимвольно без кольору."""
    # sys.stdout.write(color) # Видалено встановлення кольору
    for char in text:
        sys.stdout.write(char)
        sys.stdout.flush()
        time.sleep(delay)
    # sys.stdout.write(Style.RESET_ALL) # Видалено скидання кольору
    
    if end_with_newline:
        print() # Додаємо новий рядок, якщо потрібно
    # Якщо end_with_newline=False, курсор залишиться після тексту.


def display_splash_screen(duration=3):
    # Виклик slow_print тепер не встановлює колір
    slow_print("Ласкаво просимо до нашої гри!", delay=0.05) 
    # play_sound_threaded("sounds/splash.wav", duration=duration)
    time.sleep(duration)

# функція colored_input
def colored_input(prompt_text_for_slow_print, prompt_for_input="> "):

    slow_print(prompt_text_for_slow_print, end_with_newline=False)

    input_prompt_plain = prompt_for_input 

    while True:
        try:
            user_input_str = input(input_prompt_plain) 
            user_input_int = int(user_input_str)
            return user_input_int
        except ValueError:
            slow_print("Помилка: Будь ласка, введіть дійсне число.")
            slow_print(prompt_text_for_slow_print, end_with_newline=False)
        except Exception as e: # Обробка інших можливих помилок (рідко для input)
            slow_print(f"Сталася неочікувана помилка: {e}")
            slow_print(prompt_text_for_slow_print, end_with_newline=False)


#Функції для гри

def go_to_library_after_diary(): #Повернення до бібліотеки після щоденника
    slow_print("\nТи вирушаєш до бібліотеки, сподіваючись знайти більше інформації про стару кімнату на третьому поверсі.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Пошукати в секції історії Гоґвортсу.\n2. Запитати у мадам Пінс про старі кімнати.\n3. Переглянути старі плани замку."))
    if action == "1":
        slow_print("\nТи годинами проглядаєш полиці з книгами з історії Гоґвортсу. Нарешті, в одній запиленій книзі ти знаходиш згадку про кімнату, яка колись використовувалася для зберігання пошкоджених артефактів. Згідно з записом, її закрили багато років тому після нещасного випадку.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Продовжити пошуки згадок про цей нещасний випадок.\n2. Спробувати знайти цю кімнату, використовуючи опис з книги."))
        if action == "1":
            slow_print("\nПодальші записи розповідають про те, як люди відкривали ту кімнату. І в ній померла одна дівчина. Там дуже небезпечно.", color=Fore.YELLOW, delay=0.05)
            slow_print("Тепер ти розумієш, чому про цю кімнату ніхто не говорить.", color=Fore.YELLOW, delay=0.05)
            return # Завершення цієї гілки в бібліотеці
        elif action == "2":
            slow_print("\nОпис з книги досить розпливчастий, але ти вирішуєш спробувати знайти кімнату на третьому поверсі.", color=Fore.GREEN, delay=0.05)
            sleep(2) # Перехід до пошуку кімнати
            slow_print("Нажаль ти нічого не знайшов.", color=Fore.YELLOW, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return go_to_library_after_diary()
    elif action == "2":
        slow_print("\nТи підходиш до мадам Пінс і питаєш про старі, закриті кімнати на третьому поверсі. Вона дивиться на тебе з підозрою і каже, що всі кімнати Гоґвортсу використовуються. На твої наполягання вона лише суворо радить не цікавитися тим, що тебе не стосується.", color=Fore.YELLOW, delay=0.05)
        slow_print("Розмова з мадам Пінс не дала жодних результатів.", color=Fore.YELLOW, delay=0.05)
        return # Завершення цієї гілки в бібліотеці
    elif action == "3":
        slow_print("\nТи знаходиш старі плани Гоґвортсу, але вони виявляються неповними і нечіткими. Третій поверх зображений дуже схематично, і жодна кімната не позначена як 'закрита' або 'стара'.", color=Fore.YELLOW, delay=0.05)
        slow_print("Плани не допомогли тобі знайти потрібну кімнату.", color=Fore.YELLOW, delay=0.05)
        return # Завершення цієї гілки в бібліотеці
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        return go_to_library_after_diary()

def library(): #Події в бібліотека
    slow_print("\nВ бібліотеці ти знаходиш кілька старих книг, які згадують про цю книгу. Вони говорять про таємні знання і магію, яка може бути небезпечною.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Продовжити дослідження книги.\n2. Запитати у бібліотекарки про цю книгу."))
    if action == "1":
        slow_print("\nТи продовжуєш досліджувати книгу, але раптом відчуваєш, що хтось спостерігає за тобою. Ти обертаєшся і бачиш однокурсника. Підійдеш до нього?", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Так.\n2. Ні."))
        if action == "1":
            slow_print("Ти підходиш до однокурсника, і він з подивом запитує, чому ти тут. Ти розповідаєш йому про книгу, і він пропонує допомогти тобі в дослідженні.", color=Fore.CYAN, delay=0.05)
            action = str(colored_input(Fore.GREEN + "1. Продовжити дослідження разом.\n2. Відмовитися від його допомоги."))
            if action =="1":   
                slow_print("\nВи разом знаходите ще кілька старих книг, які згадують про цю книгу. Вони говорять про таємні знання і магію, яка може бути небезпечною.", color=Fore.CYAN, delay=0.05)
                action = str(colored_input(Fore.GREEN + "1. Спробувати розшифрувати послання.\n2. Запитати однокурсника, чи знає він щось про це шифрування."))
                if action == "1":
                    slow_print("\nПісля довгих спроб тобі вдається розшифрувати послання. Воно вказує на таємну кімнату в замку, де зберігається могутній артефакт.", color=Fore.YELLOW, delay=0.05)
                    slow_print("Твоє дослідження привело тебе до важливої підказки, яка може стати ключем до розгадки головної таємниці Гоґвортсу.", color=Fore.GREEN, delay=0.05)
                elif action == "2":
                    slow_print("\nТвій однокурсник впізнає шифр! Він розповідає, що це стародавня магічна писемність, і він знає, як її читати. Разом ви розшифровуєте послання, яке вказує на таємну кімнату в замку, де зберігається могутній артефакт.", color=Fore.GREEN, delay=0.05)
                    slow_print("Твоє дослідження привело тебе до важливої підказки, яка може стати ключем до розгадки головної таємниці Гоґвортсу.", color=Fore.GREEN, delay=0.05)
                     
                else:
                    slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
                    library()
            elif action == "2":
                slow_print("\nТи дякуєш за пропозицію, але вирішуєш продовжити самостійно. Ти відчуваєш, що ця таємниця призначена лише для тебе.", color=Fore.YELLOW, delay=0.05)
                slow_print("Продовжуючи дослідження, ти натрапляєш на ледь помітну закладку в одній із книг. За нею ховається карта з позначеним на ній таємним місцем у замку.", color=Fore.GREEN, delay=0.05)

            else:
                slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
                return "бібліотека"
        elif action == "2":
            slow_print("\nТи вирішуєш не підходити до однокурсника і робиш вигляд, що нічого не помітив(ла). Проте відчуття, що за тобою спостерігають, не покидає тебе.", color=Fore.YELLOW, delay=0.05)
            slow_print("Зрештою, ти знаходиш ще одну книгу, в якій згадується про ритуал, пов'язаний з першою книгою, і про місце, де цей ритуал колись проводився - закинуту вежу на околиці замку.", color=Fore.GREEN, delay=0.05)
            return "закинута_вежа" # Повертаємо маркер
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return library()
    elif action == "2":
        slow_print("\nТи підходиш до мадам Пінс і показуєш їй книгу. Вона помітно блідніє і суворо наказує тобі негайно повернути її на полицю. Вона бурмоче щось про 'заборонені знання' і 'небезпечні наслідки'.", color=Fore.RED, delay=0.05)
        slow_print("Її реакція здається тобі дуже дивною. Ти розумієш, що ця книга дійсно щось приховує.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Негайно повернути книгу.\n2. Непомітно спробувати запам'ятати її розташування."))
        if action == "1":
            slow_print("\nТи повертаєш книгу.", color=Fore.YELLOW, delay=0.05)
            exit()
        elif action == "2":
            slow_print("\nТи непомітно запам'ятовуєш місцезнаходження книги, плануючи повернутися за нею пізніше.", color=Fore.YELLOW, delay=0.05)

        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return library()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        return library()
    
def ask_about_book(): #Питання про книгу
    slow_print("\nТи підходиш до старшокурсника і питаєш про книгу. Він неохоче показує тобі її - це старий том із дивними символами на обкладинці. Він каже, що знайшов її у забороненій секції бібліотеки.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Попросити показати книгу детальніше.\n2. Запропонувати разом дослідити книгу.\n3. Повідомити про знахідку бібліотекарку мадам Пінс."))
    if action == "1":
        slow_print("\nСтаршокурсник знову ховає книгу під мантію і йде геть. Ти відчуваєш, що щось тут не так...", color=Fore.YELLOW, delay=0.05)
    elif action == "2":
        slow_print("\nСтаршокурсник згоджується, але тільки якщо ти обіцяєш не розповідати про це нікому. Ви вирушаєте до бібліотеки, щоб знайти більше інформації про книгу.", color=Fore.CYAN, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Пошукати в бібліотеці інформацію про книгу.\n2. Запитати у бібліотекарки про цю книгу.\n3. Спробувати розгадати символи на обкладинці."))
        if action == "1":
            library()
        elif action == "2":
            slow_print("\nБібліотекарка з подивом дивиться на тебе і каже, що ця книга заборонена для читання. \n *Вона забрала твою книгу.*", color=Fore.YELLOW, delay=0.05)
            exit()
        elif action == "3":
            slow_print("\nТи намагаєшся розгадати символи, але вони виявляються занадто складними. Ти вирішуєш все таки сходити до бібліотеки.", color=Fore.CYAN, delay=0.05)
            library()

def explore_common_room(): #Дослідження загальної кімнати
    slow_print("\nТи починаєш оглядати вітальню. За однією з картин ти помічаєш ледь помітну щілину...", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати зазирнути в щілину.\n2. Пошукати, чи є якийсь механізм, щоб відкрити її.\n3. Запитати інших гриффіндорців про цю щілину."))
    if action == "1":
        slow_print("\nТи обережно заглядаєш у щілину. Вона виявляється досить глибокою і темною. Знизу долинає слабкий шепіт, але розібрати слова неможливо. Після хвилини напруженого слухання шепіт стихає. Ти не знаходиш нічого цікавого.", color=Fore.YELLOW, delay=0.05)
        slow_print("Ти вирішуєш, що щілина, ймовірно, веде до старої вентиляційної шахти і не представляє особливого інтересу.", color=Fore.YELLOW, delay=0.05)
        return # Завершення гілки дослідження щілини
    elif action == "2":
        slow_print("\nТи починаєш уважно оглядати картину та стіну навколо неї. Проводячи руками по поверхні, ти випадково натискаєш на ледь помітний виступ у рамі картини. Чується тихий клацання, і картина злегка відхиляється, відкриваючи невелику нішу.", color=Fore.YELLOW, delay=0.05)
        slow_print("У ніші ти знаходиш старий, потертий шкіряний щоденник. Ти вирішуєш, що це може бути цікавішим за щілину.", color=Fore.YELLOW, delay=0.05)
        return "знайдено_щоденник" 
    elif action == "3":
        slow_print("\nТи питаєш кількох гриффіндорців про цю щілину за картиною. Більшість знизують плечима, але одна старокурсниця згадує, що колись чула легенду про те, що за цією картиною ховається прохід до старої кімнати, де колись зберігалися шкільні трофеї.", color=Fore.YELLOW, delay=0.05)
        slow_print("Проте вона не знає, як його відкрити, і каже, що багато хто намагався, але безуспішно. Ти розумієш, що без додаткових зусиль тобі туди не потрапити.", color=Fore.YELLOW, delay=0.05)
        exit()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        return explore_common_room() # Повернення до вибору, якщо введено недійсне значення

def report_to_prefect(): #Доповідь старості
    slow_print("\nТи розповідаєш старості про старшокурсника з підозрілою книгою. Староста дякує тобі і обіцяє розібратися.", color=Fore.CYAN, delay=0.05)
    slow_print("Можливо, ти зробив(ла) правильно, але чи не втратив(ла) ти шанс дізнатися щось цікаве самостійно?", color=Fore.YELLOW, delay=0.05)
    exit()

def eavesdrop(): #Підслуховування
    slow_print("\nТи намагаєшся підслухати розмову слизеринців. Вони говорять про 'Кімнату Таємниць' і про те, що хтось намагається її знову відкрити.", color=Fore.CYAN)
    action = str(colored_input(Fore.GREEN + "1. Спробувати дізнатися, хто саме.\n2. Спробувати знайти цю 'Кімнату Таємниць'.\n3. Розповісти про це комусь із друзів з іншого факультету."))
    if action == "1":
        slow_print("\nТи намагаєшся підслухати їхню розмову, але вони помічають тебе і швидко замовкають. Ти відчуваєш, що щось тут не так...", color=Fore.YELLOW, delay=0.05)
        slow_print("Ти вирішуєш, що краще не втручатися в чужі справи.", color=Fore.YELLOW, delay=0.05)
        exit()
        
    elif action == "2":
        slow_print("\nТи вирішуєш спробувати знайти цю 'Кімнату Таємниць' самостійно. Ти починаєш досліджувати замок, але безуспішно. Виглядає так, ніби ця кімната дійсно існує, але її важко знайти.", color=Fore.YELLOW, delay=0.05)
        slow_print("Ти розумієш, що без додаткових підказок тобі не обійтися.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "Підеш в бібліотеку? \n 1. Так \n 2. Ні"))
        if action == "1":
            go_to_library_after_diary()
        elif action == "2":
            slow_print("\nТи вирішуєш не йти в бібліотеку і продовжити свої пошуки самостійно. Ти нажаль нічого не знайшов.", color=Fore.YELLOW, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return eavesdrop()

def investigate_room(): #Дослідження кімнати
    slow_print("\nТи починаєш розпитувати про стару кімнату на третьому поверсі. Ніхто не знає про неї нічого конкретного, але ходять різні чутки...", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати знайти цю кімнату самостійно.\n2. Пошукати інформацію в бібліотеці про старі кімнати Гоґвортсу.\n3. Запитати привидів - вони можуть знати історію замку."))
    if action == "1":
        slow_print("\nТи вирушаєш на пошуки старої кімнати. Після кількох годин блукання по замку.", color=Fore.GREEN, delay=0.05)
        sleep(1)
        slow_print("Ти нажаль нічого не знайшов.", color=Fore.YELLOW, delay=0.05)
        exit()
    elif action == "2":
        slow_print("\nТи вирушаєш до бібліотеки, сподіваючись знайти більше інформації про стару кімнату на третьому поверсі.", color=Fore.CYAN, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Пошукати в секції історії Гоґвортсу.\n2. Запитати у мадам Пінс про старі кімнати.\n3. Переглянути старі плани замку."))
        if action == "1":
            slow_print("\nТи годинами проглядаєш полиці з книгами з історії Гоґвортсу. Нарешті, в одній запиленій книзі ти знаходиш згадку про кімнату, яка колись використовувалася для зберігання пошкоджених артефактів. Згідно з записом, її закрили багато років тому після нещасного випадку.", color=Fore.YELLOW, delay=0.05)
            action = str(colored_input(Fore.GREEN + "1. Продовжити пошуки згадок про цей нещасний випадок.\n2. Спробувати знайти цю кімнату, використовуючи опис з книги."))
            if action == "1":
                slow_print("\nПодальші записи розповідають про те, як люди відкривали ту кімнату. І в ній померла одна дівчина. Там дуже небезпечно.", color=Fore.RED)
                slow_print("Тепер ти розумієш, чому про цю кімнату ніхто не говорить.", color=Fore.YELLOW, delay=0.05)
                exit()
        elif action == "2":
            slow_print("\nТи підходиш до мадам Пінс і питаєш про старі, закриті кімнати на третьому поверсі. Вона дивиться на тебе з підозрою і каже, що всі кімнати Гоґвортсу використовуються. На твої наполягання вона лише суворо радить не цікавитися тим, що тебе не стосується.", color=Fore.RED, delay=0.05)
            slow_print("Розмова з мадам Пінс не дала жодних результатів.", color=Fore.YELLOW, delay=0.05)
            exit()
        elif action == "3":
            slow_print("\nТи знаходиш старі плани Гоґвортсу, але вони виявляються неповними і нечіткими. Третій поверх зображений дуже схематично, і жодна кімната не позначена як 'закрита' або 'стара'.", color=Fore.YELLOW, delay=0.05)
            slow_print("Плани не допомогли тобі знайти потрібну кімнату.", color=Fore.YELLOW, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return investigate_room()
    elif action == "3":
        slow_print("\nТи вирушаєш до привидів, сподіваючись дізнатися більше про стару кімнату. Привиди згадують, що колись там проводилися таємні збори учнів, але він не знає, чому кімната була закрита.", color=Fore.CYAN, delay=0.05)
        exit()
    else:   
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        return investigate_room()
                
def ignore_conversation(): #Ігнорування розмови
    slow_print("\nТи вирішуєш не втручатися в чужі справи і займаєшся своїми.", color=Fore.CYAN, delay=0.05)
    slow_print("Можливо, ти пропустив(ла) щось важливе...", color=Fore.YELLOW, delay=0.05)
    exit()

def solve_puzzle():   #Розв'язання головоломки
    slow_print("\nТи берешся за головоломку. Вона виявляється досить складною, але після деяких роздумів тобі вдається зрушити один із елементів. Головоломка відкривається, і всередині ти знаходиш невеликий згорток пергаменту з дивним написом.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати розшифрувати напис.\n2. Показати пергамент іншим рейвенкловцям.\n3. Зберегти пергамент і спробувати знайти йому застосування пізніше."))
    if action == "1":
        slow_print("\nТи намагаєшся розшифрувати напис, але він виявляється занадто складним. Ти вирішуєш, що краще спробувати знайти допомогу.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Запитати у старшокурсників про цей напис.\n2. Показати пергамент професору."))
        if action == "1":
            slow_print("\nТи запитуєш старшокурсників про напис, і один із них впізнає його! Він каже, що це стародавня магічна писемність, і він знає, як її читати. Разом ви розшифровуєте послання.", color=Fore.GREEN, delay=0.05)
            slow_print("Послання вказує на таємну кімнату в замку, де зберігається могутній артефакт.", color=Fore.YELLOW, delay=0.05)
            slow_print("Твоє дослідження привело тебе до важливої підказки, яка може стати ключем до розгадки головної таємниці Гоґвортсу.", color=Fore.GREEN, delay=0.05)
            action = str(colored_input(Fore.GREEN + "1. Спробувати знайти цю кімнату самостійно.\n2. Пошукати інформацію в бібліотеці про старі кімнати Гоґвортсу."))
            if action == "1":
                slow_print("\nТи вирушаєш на пошуки таємної кімнати. Після кількох годин блукання по замку ти нарешті знаходиш її. Вона виявляється закритою, але ти знайшов(ла) ключ!", color=Fore.GREEN, delay=0.05)
                slow_print("Ти відкриваєш двері і входиш у кімнату. Всередині ти знаходиш стародавній артефакт, який може змінити хід історії Гоґвортсу.", color=Fore.YELLOW, delay=0.05)
                sleep(2)
                slow_print("Твоє дослідження призвело тебе до важливого відкриття, яке може змінити все.", color=Fore.GREEN, delay=0.05)
                sleep(1)
                slow_print("Ти стаєш героєм Гоґвортсу!", color=Fore.YELLOW, delay=0.05)
                exit()
                
        elif action == "2":
            slow_print("\nТи показуєш пергамент професору, і він з подивом дивиться на тебе. Він каже, що це дуже давній артефакт і щоб ти не сунува.", color=Fore.RED, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return solve_puzzle()
    elif action == "2":
        slow_print("\nТи показуєш пергамент іншим рейвенкловцям, і вони з подивом дивляться на тебе. Один із них каже, що це дуже давній артефакт і що його краще не чіпати.", color=Fore.YELLOW, delay=0.05)
        slow_print("Вони радять тобі віднести його професору для перевірки.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Віднести пергамент професору.\n2. Спробувати розгадати його самостійно."))
        if action == "1":
            slow_print("\nТи відносиш пергамент професору, і він з подивом дивиться на тебе. Він каже, що це дуже давній артефакт і що ти зробив(ла) правильно, що приніс(ла) його. Але він тебе попросив не займатись цією справою, бо ти на першому курсі і тобі не варто за це братись.", color=Fore.GREEN, delay=0.05)
            exit()
        elif action == "2":
            slow_print("\nТи вирішуєш спробувати розгадати його самостійно. Ти проводиш кілька годин за роздумами, але безуспішно.", color=Fore.YELLOW, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return solve_puzzle()

def research_symbol(): #Дослідження символу
    slow_print("\nТи починаєш шукати в книгах інформацію про в символ. Через деякий час ти знаходиш його зображення в стародавній книзі про магічні знаки. Здається, він пов'язаний із...", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Продовжити дослідження цього символу.\n2. Повернутися до головоломки і спробувати застосувати нові знання.\n3. Розповісти про свою знахідку комусь із викладачів."))
    if action == "1":
        slow_print("\nТи продовжуєш досліджувати символ і знаходиш його значення. Він вказує на те, що головоломка пов'язана з давнім артефактом, який проводився в Гоґвортсі.", color=Fore.YELLOW, delay=0.05)
        slow_print("Ти розумієш, що ця головоломка може бути ключем до розгадки таємниці Гоґвортсу.", color=Fore.GREEN, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Спробувати розгадати головоломку самостійно.\n2. Показати свої знахідки професору."))
        if action == "1":
                slow_print("Твоє дослідження призвело тебе до важливого відкриття, яке може змінити все.", color=Fore.GREEN, delay=0.05)
                sleep(1)
                slow_print("Ти стаєш героєм Гоґвортсу!", color=Fore.YELLOW, delay=0.05)
                exit()
        elif action == "2":
            slow_print("\nТи показуєш свої знахідки професору, і він з подивом дивиться на тебе. Він каже, що це дуже давній артефакт і що ти зробив(ла) правильно, що приніс(ла) його. Але він тебе попросив не займатись цією справою, бо ти на першому курсі і тобі не варто за це братись.", color=Fore.GREEN, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return research_symbol()

def ask_ravenclaws(): #Питання у рейвенкловців
    slow_print("\nТи питаєш інших рейвенкловців про головоломку. Деякі намагалися її розгадати, але без успіху. Одна стара учениця згадує, що колись чула легенду про цю головоломку та прихований нею секрет.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати дізнатися більше про легенду.\n2. Запропонувати іншим рейвенкловцям об'єднати зусилля для розгадки."))
    if action == "1":
        slow_print("\nТи запитуєш старшу ученицю про легенду, і вона розповідає, що головоломка пов'язана з давнім артефактом, який колись належав одному з засновників Гоґвортсу.", color=Fore.YELLOW, delay=0.05)
        slow_print("Вона також згадує, що артефакт може бути захований у таємній кімнаті в замку.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Спробувати знайти цю кімнату самостійно.\n2. Пошукати інформацію в бібліотеці про старі кімнати Гоґвортсу."))
        if action == "1":
            slow_print("\nТи вирушаєш на пошуки таємної кімнати. Після кількох годин блукання по замку ти нарешті знаходиш її. Вона виявляється закритою, але ти знайшов(ла) ключ!", color=Fore.GREEN, delay=0.05)
            slow_print("Ти відкриваєш двері і входиш у кімнату. Всередині ти знаходиш стародавній артефакт, який може змінити хід історії Гоґвортсу.", color=Fore.YELLOW, delay=0.05)
            sleep(2)
            slow_print("Твоє дослідження призвело тебе до важливого відкриття, яке може змінити все.", color=Fore.GREEN, delay=0.05)
            sleep(1)
            slow_print("Ти стаєш героєм Гоґвортсу!", color=Fore.YELLOW, delay=0.05)
            exit()  
        elif action == "2":
            slow_print("\nТи вирушаєш до бібліотеки, щоб знайти більше інформації про цю кімнату. Після кількох годин пошуків ти знаходиш стару книгу, в якій згадується ця кімната.", color=Fore.YELLOW, delay=0.05)
            slow_print("Вона описує, як потрапити туди і що там можна знайти.", color=Fore.YELLOW)
            action = str(colored_input(Fore.GREEN + "1. Спробувати знайти цю кімнату самостійно.\n2. Показати свої знахідки професору."))
            if action == "1":
                slow_print("\nТи вирушаєш на пошуки таємної кімнати. Після кількох годин блукання по замку ти нарешті знаходиш її. Вона виявляється закритою, але ти знайшов(ла) ключ!", color=Fore.GREEN, delay=0.05)
                slow_print("Ти відкриваєш двері і входиш у кімнату. Всередині ти знаходиш стародавній артефакт, який може змінити хід історії Гоґвортсу.", color=Fore.YELLOW, delay=0.05)
                sleep(2)
                slow_print("Твоє дослідження призвело тебе до важливого відкриття, яке може змінити все.", color=Fore.GREEN, delay=0.05)
                sleep(1)
                slow_print("Ти стаєш героєм Гоґвортсу!", color=Fore.YELLOW, delay=0.05)
                exit()  
            elif action == "2":
                slow_print("\nТи показуєш свої знахідки професору, і він з подивом дивиться на тебе. Він каже, що це дуже давній артефакт і що ти зробив(ла) правильно, що приніс(ла) його. Але він тебе попросив не займатись цією справою, бо ти на першому курсі і тобі не варто за це братись.", color=Fore.GREEN, delay=0.05)
                exit()
            else:
                slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
                return ask_ravenclaws()
    elif action == "2":
        slow_print("\nТи пропонуєш іншим рейвенкловцям об'єднати зусилля для розгадки головоломки. Вони не походжуються.", color=Fore.CYAN, delay=0.05)
        exit()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        return ask_ravenclaws()
    
def find_out_what_they_are_looking_for():   #Дізнатися, що вони шукають
    slow_print("\nТи намагаєшся непомітно підслухати розмову гафелпафців. Вони стурбовано шепочуться про те, що хтось шукає інгредієнт для забороненого зілля, який зберігається в одній із комор.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати дізнатися, який саме інгредієнт.\n2. Попередити завідувача кухнями.\n3. Спробувати знайти цього нишпорку самостійно."))
    if action == "1":
        slow_print("\nТи підходиш ближче і чуєш, що вони говорять про 'Серце дракона'. Це дуже рідкісний і небезпечний інгредієнт, який може бути використаний для створення потужних зілля.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Спробувати знайти цього нишпорку самостійно.\n2. Попередити завідувача кухнями."))
        if action == "1":
            slow_print("\nТи вирушаєш на пошуки нишпорки. Після кількох годин блукання по замку ти нарешті знаходиш його. Він намагається втекти, але ти його ловиш!", color=Fore.GREEN, delay=0.05)
            slow_print("Ти дізнаєшся, що він працює на одного з викладачів Гоґвортсу. Але він тебе вдарив, і ти втратив свідомість...", color=Fore.YELLOW, delay=0.05)
            exit()
        elif action == "2":
            slow_print("\nТи вирушаєш до завідувача кухнями і розповідаєш йому про свої підозри. Він дякує тобі за пильність і обіцяє перевірити комори.", color=Fore.CYAN, delay=0.05)
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return find_out_what_they_are_looking_for()

def warn_prefect(): #Попередження старости
    slow_print("\nТи розповідаєш старості Гафелпафу про підозрілих учнів у коморах. Староста дякує за твою пильність і обіцяє перевірити.", color=Fore.CYAN, delay=0.05)
    slow_print("Ти вчинив(ла) чесно, але, можливо, втратив(ла) можливість дізнатися більше про цю таємницю з перших рук.", color=Fore.YELLOW, delay=0.05)
    exit()

def offer_help(): #Пропозиція допомоги
    slow_print("\nТи пропонуєш свою допомогу гафелпафцям у пошуках. Спочатку вони здивовані, але потім погоджуються. Разом ви починаєте обшукувати комори...", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спитати, що саме вони шукають.\n2. Уважно оглядати кожну полицю та шафу."))
    if action == "1":
        slow_print("\nТи запитуєш, що саме вони шукають, і дізнаєшся, що це дуже рідкісний інгредієнт для зілля. Вони кажуть, що він може бути небезпечним у неправильних руках.", color=Fore.YELLOW, delay=0.05)
        action = str(colored_input(Fore.GREEN + "1. Спробувати дізнатися більше про цей інгредієнт.\n2. Запропонувати свою допомогу в пошуках."))
        if action == "1":
            slow_print("\nТи починаєш шукати в книгах інформацію про цей інгредієнт. Через деякий час ти знаходиш його опис у стародавній книзі про зілля.", color=Fore.CYAN, delay=0.05)
            slow_print("Виявляється, що цей інгредієнт може бути використаний для створення дуже потужного зілля, яке може змінити хід історії Гоґвортсу.", color=Fore.YELLOW, delay=0.05)
            exit()
        elif action == "2":
            slow_print("\nТи пропонуєш свою допомогу в пошуках, і вони погоджуються. Разом ви починаєте обшукувати комори... \nВи нашли той інгредієнт і віднесли вчителю, і ви стали героями!", color=Fore.CYAN, delay=0.05)
            
            exit()
        else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return offer_help()
    elif action == "2":
        slow_print("\nТи починаєш уважно оглядати кожну полицю та шафу. Після кількох годин пошуків ти знаходиш стару книгу, в якій згадується цей інгредієнт.", color=Fore.YELLOW, delay=0.05)
        slow_print("Вона описує, як його використовувати і які небезпеки можуть виникнути при неправильному використанні.", color=Fore.YELLOW, delay=0.05)
        exit()
    else:
            slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
            return offer_help()

#Факультети
    
def gryffindor_start(): #Початок гри для Грифіндору
    slow_print("\nТи опиняєшся у вітальні Ґрифіндору. Тепле світло від каміна відкидає тіні на червоно-золоті стіни. Раптом ти помічаєш, як хтось із старшокурсників нишком ховає стародавню книгу під мантію.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати підійти і розпитати про книгу.\n2. Проігнорувати і піти досліджувати вітальню.\n3. Повідомити старосту факультету."))
    if action == "1":
        ask_about_book()
    elif action == "2":
        result = explore_common_room()
        if result == "знайдено_щоденник":
            slow_print("\nЗнайдений щоденник може містити важливі відомості...", Fore.GREEN, delay=0.05)
            # Тут можна викликати функцію для читання щоденника
    elif action == "3":
        report_to_prefect()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        gryffindor_start()
        
def slytherin_start():  #Початок гри для Слизерину
    slow_print("\nТи спускаєшся до вітальні Слизерину, розташованої в підземеллі. Зелене світло від ламп відбивається від вологих кам'яних стін. Ти чуєш уривок розмови двох слизеринців про якийсь таємний план і стару кімнату на третьому поверсі.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати підслухати їхню розмову.\n2. Спробувати дізнатися більше про стару кімнату.\n3. Зайнятися своїми справами, не звертаючи уваги."))
    if action == "1":
        eavesdrop()
    elif action == "2":
        investigate_room()
    elif action == "3":
        ignore_conversation()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        slytherin_start()

def ravenclaw_start(): #Початок гри для Равенклову
    slow_print("\nТи піднімаєшся до вежі Рейвенклову. Вікна відкривають чудовий вид на околиці Гоґвортсу. Біля однієї з книжкових шаф ти помічаєш головоломку, яку ніхто не може розгадати вже кілька тижнів. На ній вигравірувано дивний символ.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати розгадати головоломку.\n2. Пошукати в книгах інформацію про символ.\n3. Запитати інших рейвенкловців про головоломку."))
    if action == "1":
        solve_puzzle()
    elif action == "2":
        research_symbol()
    elif action == "3":
        ask_ravenclaws()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        ravenclaw_start()

def hufflepuff_start(): #Початок гри для Гафелпафу
    slow_print("\nТи опиняєшся у затишній вітальні Гафелпафу, розташованій біля кухонь. Пахне свіжою випічкою. Ти випадково чуєш розмову кількох гафелпафців про те, що хтось нишпорить у коморах і шукає щось заборонене.", color=Fore.CYAN, delay=0.05)
    action = str(colored_input(Fore.GREEN + "1. Спробувати дізнатися, що саме шукають.\n2. Попередити старосту про підозрілу активність.\n3. Запропонувати свою допомогу в пошуках (з цікавості)."))
    if action == "1":
        find_out_what_they_are_looking_for()
    elif action == "2":
        warn_prefect()
    elif action == "3":
        offer_help()
    else:
        slow_print("Невідомий вибір.", Fore.RED, delay=0.05)
        hufflepuff_start()

def display_splash_screen(duration=5):
    slow_print(Fore.MAGENTA + "Ласкаво просимо до нашої гри!" + Fore.RESET)  # Колір заставки
    time.sleep(duration)  # Затримка заставки


# Функція для гри
def game():
    splash_duration = 5  # Тривалість заставки у секундах
    sound_file = "hogwarts_theme.wav"  

    # Запускаємо заставку та звук одночасно
    threading.Thread(target=play_sound_threaded, args=(sound_file), daemon=True).start()
    display_splash_screen(splash_duration)

    # Починаємо гру після заставки
    slow_print("Ти стоїш на порозі неймовірних пригод у світі магії...", Fore.CYAN)
    
    slow_print("Вітаємо тебе, юний чарівнику (юна чарівнице)! Твій лист із Гоґвортсу нарешті прибув. Ти стоїш на порозі неймовірних пригод у світі магії. Перш ніж вирушити до школи, тобі потрібно зробити кілька важливих кроків.", color=Fore.CYAN, delay=0.05)
    slow_print("Ти опиняєшся під Розподільним Капелюхом. Його старий, мудрий голос лунає у твоїй голові: 'Хмм... сміливість? хитрість? мудрість? вірність? Куди ж тебе визначити?'", color=Fore.CYAN, delay=0.05)
    choice = str(colored_input(Fore.GREEN + "\n1. Сказати, що цінуєш сміливість понад усе. \n2. Заявити про свою амбітність і бажання досягти великих висот. \n3. Наголосити на своїй кмітливості та жазі знань. \n4. Підкреслити свою відданість друзям і чесність."))
    if choice == "1":
        slow_print("Ти обрав шлях сміливості. Тепер ти в Грифіндорі.", color=Fore.YELLOW, delay=0.05)
        gryffindor_start()
    elif choice == "2":
        slow_print("Ти обрав шлях амбіцій. Тепер ти в Слизерині.", color=Fore.YELLOW, delay=0.05)
        slytherin_start()
    elif choice == "3":
        slow_print("Ти обрав шлях кмітливості. Тепер ти в Равенклові.", color=Fore.YELLOW, delay=0.05)
        ravenclaw_start()
    elif choice == "4":
        slow_print("Ти обрав шлях відданості. Тепер ти в Гафелпафі.", color=Fore.YELLOW, delay=0.05)
        hufflepuff_start()
    else:
        slow_print( "Невідомий вибір. Спробуй ще раз.", color=Fore.RED, delay=0.05)
        game()

if __name__ == "__main__":
    game() # Запускаємо функцію game()
